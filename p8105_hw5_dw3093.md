p8105_hw5_dw3093
================
Katherine Wang

\#Question 1

``` r
shared_bday <- function(n) {
  bday <- sample(1:365, size = n, replace = TRUE) 
  return(any(duplicated(bday)))
}
group_sizes <- 2:50
n_simulation <- 10000

prob <- numeric(length(group_sizes))
for (i in seq_along(group_sizes)) {
  group_size <- group_sizes[i]

  results <- replicate(n_simulation, shared_bday(group_size))
  prob[i] <- mean(results)
}
results <- data.frame(
  group_size = group_sizes,
  probability = prob
)

ggplot(results, aes(x = group_size, y = probability)) +
  geom_line() +
  geom_point(alpha=.6) +
  labs(
    title = "Probability of Shared Birthday as a Function of Group Size",
    x = "Group Size (n)",
    y = "Probability of Shared Birthday"
  ) +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold")
  )
```

<img src="p8105_hw5_dw3093_files/figure-gfm/unnamed-chunk-2-1.png" width="90%" />
We can conclude that the probability of a shared birthday is low with
small group sizes. However, as the group size increases, the probability
rises sharply, reaching over 50% by around 23 people and approaching
near certainty by 50 people.

# Question 2

# Set up parameters as question required

``` r
n <- 30
sigma <- 5
alpha <- 0.05
mu_values <- 0:6
n_simulations <- 5000
```

# Function to simulate data

``` r
t_test <- function(mu) {
  sample_data <- rnorm(n = n, mean = mu, sd = sigma)
  t_stats <- t.test(sample_data, mu = 0) |>
    broom::tidy() |>
    select(estimate, p.value)
  return(t_stats)
}
```

# Generate simulation results for each mu value

``` r
simulation_results <- tibble(
  mu = rep(mu_values, each = n_simulations)
) |>
  mutate(
    t_test_output = map(mu, t_test)
  ) |>
  unnest(cols = t_test_output)
```

# Calculate power and average estimates

``` r
summary_results <- simulation_results |>
  group_by(mu) |>
  summarize(
    power = mean(p.value < alpha),
    avg_est_all = mean(estimate),
    avg_est_rej = mean(estimate[p.value < alpha], na.rm = TRUE),
    .groups = 'drop'
  )
```

# Plot 1: Power vs. True Value of μ

``` r
ggplot(summary_results, aes(x = mu, y = power)) +
  geom_line() +
  geom_point() +
  labs(
    title = "Power of the t-test vs. True Value of μ",
    x = "True Value of μ",
    y = "Power (Proportion of Null Rejections)"
  ) +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold")
)
```

<img src="p8105_hw5_dw3093_files/figure-gfm/unnamed-chunk-7-1.png" width="90%" />

# Plot 2: Average Estimate vs. True Mean (mu)

``` r
ggplot(summary_results, aes(x = mu)) +
  geom_line(aes(y = avg_est_all, color = "All Samples")) +
  geom_point(aes(y = avg_est_all, color = "All Samples")) +
  geom_line(aes(y = avg_est_rej, color = "Null Rejected Samples")) +
  geom_point(aes(y = avg_est_rej, color = "Null Rejected Samples")) +
  labs(
    title = "Average Estimate of Sample Mean (μ̂) vs. True Mean (μ)",
    x = "True Mean (μ)",
    y = "Average Estimate of Sample Mean (μ̂)",
    color = "Sample Type"
  ) +
  scale_color_manual(
    values = c("All Samples" = "orange", "Null Rejected Samples" = "pink"),
    labels = c("All Samples", "Null Rejected Samples")
  ) +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold")
)
```

<img src="p8105_hw5_dw3093_files/figure-gfm/unnamed-chunk-8-1.png" width="90%" />
\# Question 3 \#Load dataset from github

``` r
homicide = read_csv("https://raw.githubusercontent.com/washingtonpost/data-homicides/refs/heads/master/homicide-data.csv")
```

    ## Rows: 52179 Columns: 12
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (9): uid, victim_last, victim_first, victim_race, victim_age, victim_sex...
    ## dbl (3): reported_date, lat, lon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
head(homicide)
```

    ## # A tibble: 6 × 12
    ##   uid   reported_date victim_last victim_first victim_race victim_age victim_sex
    ##   <chr>         <dbl> <chr>       <chr>        <chr>       <chr>      <chr>     
    ## 1 Alb-…      20100504 GARCIA      JUAN         Hispanic    78         Male      
    ## 2 Alb-…      20100216 MONTOYA     CAMERON      Hispanic    17         Male      
    ## 3 Alb-…      20100601 SATTERFIELD VIVIANA      White       15         Female    
    ## 4 Alb-…      20100101 MENDIOLA    CARLOS       Hispanic    32         Male      
    ## 5 Alb-…      20100102 MULA        VIVIAN       White       72         Female    
    ## 6 Alb-…      20100126 BOOK        GERALDINE    White       91         Female    
    ## # ℹ 5 more variables: city <chr>, state <chr>, lat <dbl>, lon <dbl>,
    ## #   disposition <chr>
